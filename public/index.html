<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Short Film Show - Live</title>
    <script src="https://cdn.jsdelivr.net/npm/shaka-player@4.7.11/dist/shaka-player.ui.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/shaka-player@4.7.11/dist/controls.css">
    <style>
        :root { --brand-gold: #D4AF37; --bg: #050505; }
        body { background: var(--bg); color: white; font-family: sans-serif; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { width: 90%; max-width: 1000px; }
        .video-container { position: relative; width: 100%; aspect-ratio: 16/9; background: #000; border-radius: 12px; overflow: hidden; border: 1px solid rgba(212, 175, 55, 0.2); }
        .info-card { margin-top: 20px; padding: 20px; background: #111; border-radius: 12px; border-top: 3px solid var(--brand-gold); }
        .live-tag { background: #e50914; color: white; padding: 4px 12px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; text-transform: uppercase; margin-right: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="video-container" id="video-parent">
            <video id="video" style="width:100%;height:100%" autoplay muted playsinline></video>
        </div>
        <div class="info-card">
            <div><span class="live-tag">Live</span><span id="now-title" style="font-size: 1.5rem; font-weight: bold;">Loading...</span></div>
            <p id="now-synopsis" style="color: #aaa; margin-top: 10px;">Connecting...</p>
            <a id="film-link" href="#" target="_blank" style="display:inline-block; margin-top: 15px; color: var(--brand-gold); text-decoration: none; border: 1px solid var(--brand-gold); padding: 8px 20px; border-radius: 5px;">View Film Details</a>
        </div>
    </div>
    <script>
        async function init() {
            const video = document.getElementById('video');
            const videoParent = document.getElementById('video-parent');
            const player = new shaka.Player(video);
            const ui = new shaka.ui.Overlay(player, videoParent, video);
            try {
                const res = await fetch('/api/live-status');
                const data = await res.json();
                document.getElementById('now-title').innerText = data.title;
                document.getElementById('now-synopsis').innerText = data.synopsis;
                document.getElementById('film-link').href = data.filmPageUrl || '#';
                await player.load(data.streamUrl);
            } catch (e) { console.error(e); }
        }
        document.addEventListener('shaka-ui-loaded', init);
    </script>
</body>
</html>
